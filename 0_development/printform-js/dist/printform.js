var PrintForm=function(){"use strict";const j=new Set(["y","yes","true","1"]),X=new Set(["n","no","false","0"]);function u(r,o){if(r==null||r==="")return o;if(typeof r=="boolean")return r;if(typeof r=="number")return r!==0;const e=String(r).trim().toLowerCase();return j.has(e)?!0:X.has(e)?!1:o}function _(r,o){if(r==null||r==="")return o;const e=Number(r);return Number.isFinite(e)?e:o}function C(r,o){return r==null||r===""?o:String(r)}function Z(r){const o=String(r||"").trim().toLowerCase();return o==="landscape"?"landscape":o==="portrait"?"portrait":""}function J(r){const o=String(r||"").trim();if(!o)return"";const e=o.toUpperCase();return e==="A4"||e==="A5"||e==="LETTER"||e==="LEGAL"?e:e==="US_LETTER"||e==="USLETTER"?"LETTER":e==="US_LEGAL"||e==="USLEGAL"?"LEGAL":""}function A(r,o){const e=Number(r),t=Number(o);return!Number.isFinite(e)||!Number.isFinite(t)||t<=0?0:Math.round(e/25.4*t)}const Q={A4:{widthMm:210,heightMm:297},A5:{widthMm:148,heightMm:210},LETTER:{widthMm:215.9,heightMm:279.4},LEGAL:{widthMm:215.9,heightMm:355.6}};function Y(r){const o=J(r&&r.paperSize);if(!o)return null;const e=Q[o];if(!e)return null;const t=Number(r&&r.dpi),a=A(e.widthMm,t),i=A(e.heightMm,t);return!a||!i?null:(Z(r&&r.orientation)||"portrait")==="landscape"?{width:i,height:a}:{width:a,height:i}}function m(r){const o=Number(r);return Number.isFinite(o)?Math.max(0,Math.round(o)):0}function ee(r){if(!r)return null;if(r.__pageNumberPlaceholder)return r.__pageNumberPlaceholder;const o=r.ownerDocument||(typeof document<"u"?document:null);if(!o)return null;let e=r.querySelector("[data-page-number-container]");e||(e=r.querySelector("td:last-child")||r.querySelector("td")||r);const t=o.createElement("span");return t.className="printform_page_number_placeholder",e.appendChild(t),r.__pageNumberPlaceholder=t,t}function te(r){if(!r)return null;if(r.__physicalPageNumberPlaceholder)return r.__physicalPageNumberPlaceholder;const o=r.ownerDocument||(typeof document<"u"?document:null);if(!o)return null;let e=r.querySelector("[data-physical-page-number-container]");e||(e=r.querySelector("td:last-child")||r.querySelector("td")||r);const t=o.createElement("span");return t.className="printform_physical_page_number_placeholder",e.appendChild(t),r.__physicalPageNumberPlaceholder=t,t}function I(r,o,e){if(!r)return;const t=r.querySelectorAll("[data-page-number]");t.length>0&&t.forEach(function(n){n.textContent=o});const a=r.querySelectorAll("[data-page-total]"),i=e??"";if(a.length>0&&a.forEach(function(n){n.textContent=i}),t.length===0&&a.length===0){const n=ee(r);n&&(n.textContent=e!=null?"Page "+o+" of "+e:"Page "+o)}}function V(r,o,e){if(!r)return;const t=r.querySelectorAll("[data-physical-page-number]");t.length>0&&t.forEach(function(n){n.textContent=o});const a=r.querySelectorAll("[data-physical-page-total]"),i=e??"";if(a.length>0&&a.forEach(function(n){n.textContent=i}),t.length===0&&a.length===0){const n=te(r);n&&(n.textContent=e!=null?"Sheet "+o+" of "+e:"Sheet "+o)}}const x=[{key:"papersizeWidth",datasetKey:"papersizeWidth",legacyKey:"papersize_width",defaultValue:750,parser:_},{key:"papersizeHeight",datasetKey:"papersizeHeight",legacyKey:"papersize_height",defaultValue:1050,parser:_},{key:"paperSize",datasetKey:"paperSize",legacyKey:"paper_size",defaultValue:"",parser:C},{key:"orientation",datasetKey:"orientation",legacyKey:"orientation",defaultValue:"portrait",parser:C},{key:"dpi",datasetKey:"dpi",legacyKey:"dpi",defaultValue:96,parser:_},{key:"nUp",datasetKey:"nUp",legacyKey:"n_up",defaultValue:1,parser:_},{key:"showLogicalPageNumber",datasetKey:"showLogicalPageNumber",legacyKey:"show_logical_page_number",defaultValue:!0,parser:u},{key:"showPhysicalPageNumber",datasetKey:"showPhysicalPageNumber",legacyKey:"show_physical_page_number",defaultValue:!1,parser:u},{key:"heightOfDummyRowItem",datasetKey:"heightOfDummyRowItem",legacyKey:"height_of_dummy_row_item",defaultValue:18,parser:_},{key:"repeatHeader",datasetKey:"repeatHeader",legacyKey:"repeat_header",defaultValue:!0,parser:u},{key:"repeatDocinfo",datasetKey:"repeatDocinfo",legacyKey:"repeat_docinfo",defaultValue:!0,parser:u},{key:"repeatDocinfo002",datasetKey:"repeatDocinfo002",legacyKey:"repeat_docinfo002",defaultValue:!0,parser:u},{key:"repeatDocinfo003",datasetKey:"repeatDocinfo003",legacyKey:"repeat_docinfo003",defaultValue:!0,parser:u},{key:"repeatDocinfo004",datasetKey:"repeatDocinfo004",legacyKey:"repeat_docinfo004",defaultValue:!0,parser:u},{key:"repeatDocinfo005",datasetKey:"repeatDocinfo005",legacyKey:"repeat_docinfo005",defaultValue:!0,parser:u},{key:"repeatRowheader",datasetKey:"repeatRowheader",legacyKey:"repeat_rowheader",defaultValue:!0,parser:u},{key:"repeatPtacRowheader",datasetKey:"repeatPtacRowheader",legacyKey:"repeat_ptac_rowheader",defaultValue:!0,parser:u},{key:"repeatFooter",datasetKey:"repeatFooter",legacyKey:"repeat_footer",defaultValue:!1,parser:u},{key:"repeatFooter002",datasetKey:"repeatFooter002",legacyKey:"repeat_footer002",defaultValue:!1,parser:u},{key:"repeatFooter003",datasetKey:"repeatFooter003",legacyKey:"repeat_footer003",defaultValue:!1,parser:u},{key:"repeatFooter004",datasetKey:"repeatFooter004",legacyKey:"repeat_footer004",defaultValue:!1,parser:u},{key:"repeatFooter005",datasetKey:"repeatFooter005",legacyKey:"repeat_footer005",defaultValue:!1,parser:u},{key:"repeatFooterLogo",datasetKey:"repeatFooterLogo",legacyKey:"repeat_footer_logo",defaultValue:!1,parser:u},{key:"repeatFooterPagenum",datasetKey:"repeatFooterPagenum",legacyKey:"repeat_footer_pagenum",defaultValue:!1,parser:u},{key:"fillPageHeightAfterFooter",datasetKey:"fillPageHeightAfterFooter",legacyKey:"fill_page_height_after_footer",defaultValue:!0,parser:u},{key:"insertDummyRowItemWhileFormatTable",datasetKey:"insertDummyRowItemWhileFormatTable",legacyKey:"insert_dummy_row_item_while_format_table",defaultValue:!0,parser:u},{key:"insertPtacDummyRowItems",datasetKey:"insertPtacDummyRowItems",legacyKey:"insert_ptac_dummy_row_items",defaultValue:!0,parser:u},{key:"insertDummyRowWhileFormatTable",datasetKey:"insertDummyRowWhileFormatTable",legacyKey:"insert_dummy_row_while_format_table",defaultValue:!1,parser:u},{key:"insertFooterSpacerWhileFormatTable",datasetKey:"insertFooterSpacerWhileFormatTable",legacyKey:"insert_footer_spacer_while_format_table",defaultValue:!0,parser:u},{key:"insertFooterSpacerWithDummyRowItemWhileFormatTable",datasetKey:"insertFooterSpacerWithDummyRowItemWhileFormatTable",legacyKey:"insert_footer_spacer_with_dummy_row_item_while_format_table",defaultValue:!0,parser:u},{key:"customDummyRowItemContent",datasetKey:"customDummyRowItemContent",legacyKey:"custom_dummy_row_item_content",defaultValue:"",parser:C},{key:"debug",datasetKey:"debug",legacyKey:"debug_printform",defaultValue:!1,parser:u}],re=[{key:"docInfo",className:"pdocinfo",repeatFlag:"repeatDocinfo"},{key:"docInfo002",className:"pdocinfo002",repeatFlag:"repeatDocinfo002"},{key:"docInfo003",className:"pdocinfo003",repeatFlag:"repeatDocinfo003"},{key:"docInfo004",className:"pdocinfo004",repeatFlag:"repeatDocinfo004"},{key:"docInfo005",className:"pdocinfo005",repeatFlag:"repeatDocinfo005"}],v=[{key:"footer",className:"pfooter",repeatFlag:"repeatFooter"},{key:"footer002",className:"pfooter002",repeatFlag:"repeatFooter002"},{key:"footer003",className:"pfooter003",repeatFlag:"repeatFooter003"},{key:"footer004",className:"pfooter004",repeatFlag:"repeatFooter004"},{key:"footer005",className:"pfooter005",repeatFlag:"repeatFooter005"}],D={className:"pfooter_logo"},L={className:"pfooter_pagenum"},w=x.reduce((r,o)=>(r[o.key]=o.defaultValue,r),{});function M(r){const o=typeof window<"u"?window:typeof globalThis<"u"?globalThis:{};return r.reduce((e,t)=>{if(!t.legacyKey)return e;const a=o[t.legacyKey];return a==null||a===""||(e[t.key]=t.parser(a,t.defaultValue)),e},{})}function W(r,o){const e=o||{};return r.reduce((t,a)=>{if(!a.datasetKey||!Object.prototype.hasOwnProperty.call(e,a.datasetKey))return t;const i=e[a.datasetKey];return i==null||i===""||(t[a.key]=a.parser(i,a.defaultValue)),t},{})}function ae(){return M(x)}function oe(r){return W(x,r)}function ie(r,o){const e=r.querySelector("template.custom-dummy-row-item-content");return e?e.innerHTML.trim():o}function z(r,o={}){const e=ae(),t=oe(r.dataset||{}),a={...w,...e,...t,...o};a.customDummyRowItemContent=ie(r,o.customDummyRowItemContent!==void 0?o.customDummyRowItemContent:a.customDummyRowItemContent),a.debug=u(a.debug,w.debug),a.nUp=_(a.nUp,w.nUp),(!Number.isFinite(a.nUp)||a.nUp<1)&&(a.nUp=w.nUp),a.nUp=Math.floor(a.nUp),a.showLogicalPageNumber=u(a.showLogicalPageNumber,w.showLogicalPageNumber),a.showPhysicalPageNumber=u(a.showPhysicalPageNumber,w.showPhysicalPageNumber),a.papersizeWidth=_(a.papersizeWidth,w.papersizeWidth),a.papersizeHeight=_(a.papersizeHeight,w.papersizeHeight),a.paperSize=C(a.paperSize,w.paperSize),a.orientation=C(a.orientation,w.orientation),a.dpi=_(a.dpi,w.dpi),(!Number.isFinite(a.dpi)||a.dpi<=0)&&(a.dpi=w.dpi);const i=l=>Object.prototype.hasOwnProperty.call(o,l)&&o[l]!=="",n=Object.prototype.hasOwnProperty.call(e,"papersizeWidth")||Object.prototype.hasOwnProperty.call(t,"papersizeWidth")||i("papersizeWidth"),s=Object.prototype.hasOwnProperty.call(e,"papersizeHeight")||Object.prototype.hasOwnProperty.call(t,"papersizeHeight")||i("papersizeHeight");if(!n&&!s){const l=Y({paperSize:a.paperSize,orientation:a.orientation,dpi:a.dpi});l&&(a.papersizeWidth=l.width,a.papersizeHeight=l.height)}return a}const $=[{key:"repeatPaddt",datasetKey:"repeatPaddt",legacyKey:"repeat_paddt",defaultValue:!0,parser:u},{key:"insertPaddtDummyRowItems",datasetKey:"insertPaddtDummyRowItems",legacyKey:"insert_paddt_dummy_row_items",defaultValue:!0,parser:u},{key:"paddtMaxWordsPerSegment",datasetKey:"paddtMaxWordsPerSegment",legacyKey:"paddt_max_words_per_segment",defaultValue:200,parser:_},{key:"repeatPaddtRowheader",datasetKey:"repeatPaddtRowheader",legacyKey:"repeat_paddt_rowheader",defaultValue:!0,parser:u},{key:"paddtDebug",datasetKey:"paddtDebug",legacyKey:"paddt_debug",defaultValue:!1,parser:u},{key:"repeatPaddtDocinfo",datasetKey:"repeatPaddtDocinfo",legacyKey:"repeat_paddt_docinfo",defaultValue:!0,parser:u},{key:"repeatPaddtDocinfo002",datasetKey:"repeatPaddtDocinfo002",legacyKey:"repeat_paddt_docinfo002",defaultValue:!0,parser:u},{key:"repeatPaddtDocinfo003",datasetKey:"repeatPaddtDocinfo003",legacyKey:"repeat_paddt_docinfo003",defaultValue:!0,parser:u},{key:"repeatPaddtDocinfo004",datasetKey:"repeatPaddtDocinfo004",legacyKey:"repeat_paddt_docinfo004",defaultValue:!0,parser:u},{key:"repeatPaddtDocinfo005",datasetKey:"repeatPaddtDocinfo005",legacyKey:"repeat_paddt_docinfo005",defaultValue:!0,parser:u}],N=$.reduce(function(r,o){return r[o.key]=o.defaultValue,r},{});function ne(){return M($)}function se(r){return W($,r)}function pe(r,o){o=o||{};var e=ne(),t=se(r&&r.dataset||{}),a={};for(var i in N)Object.prototype.hasOwnProperty.call(N,i)&&(a[i]=N[i]);for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(a[s]=t[s]);for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l]);return a.paddtDebug=u(a.paddtDebug,N.paddtDebug),a.paddtMaxWordsPerSegment=_(a.paddtMaxWordsPerSegment,N.paddtMaxWordsPerSegment),(!Number.isFinite(a.paddtMaxWordsPerSegment)||a.paddtMaxWordsPerSegment<=0)&&(a.paddtMaxWordsPerSegment=N.paddtMaxWordsPerSegment),a}function O(r,o){const e=document.createElement("table");return e.className="dummy_row",e.setAttribute("width",`${r.papersizeWidth}px`),e.setAttribute("cellspacing","0"),e.setAttribute("cellpadding","0"),e.innerHTML=`<tr style="height:${m(o)}px;"><td style="border:0px solid black;"></td></tr>`,e}function le(r){const o=document.createElement("table");return o.className="dummy_row_item",o.setAttribute("width",`${r.papersizeWidth}px`),o.setAttribute("cellspacing","0"),o.setAttribute("cellpadding","0"),r.customDummyRowItemContent?o.innerHTML=r.customDummyRowItemContent:o.innerHTML=`<tr style="height:${m(r.heightOfDummyRowItem)}px;"><td style="border:0px solid black;"></td></tr>`,o}function B(r,o,e){const t=m(r.heightOfDummyRowItem),a=m(e);if(t<=0||a<=0)return;const i=Math.floor(a/t);for(let n=0;n<i;n+=1)o.appendChild(le(r))}function ce(r,o,e){const t=m(e);t<=0||o.appendChild(O(r,t))}function de(r,o,e,t,a){if(!r.insertDummyRowItemWhileFormatTable)return a&&console.log("[printform] applyDummyRowItemsStep: SKIPPED (insertDummyRowItemWhileFormatTable=false)"),m(t);const i=m(e-t);if(a&&(console.log("[printform] applyDummyRowItemsStep:"),console.log(`[printform]   heightPerPage: ${e}px, currentHeight: ${t}px`),console.log(`[printform]   remaining: ${i}px, itemHeight: ${r.heightOfDummyRowItem}px`)),i>0){B(r,o,i);const n=m(r.heightOfDummyRowItem);if(n>0){const s=Math.floor(i/n),l=m(i%n),p=m(e-l);return a&&(console.log(`[printform]   inserted ${s} dummy_row_items (${s} x ${n}px = ${s*n}px)`),console.log(`[printform]   remainder: ${l}px, newHeight: ${p}px`)),p}}return m(t)}function ue(r,o,e,t,a){if(!r.insertDummyRowWhileFormatTable)return a&&console.log("[printform] applyDummyRowStep: SKIPPED (insertDummyRowWhileFormatTable=false)"),m(t);const i=m(e-t);return a&&(console.log("[printform] applyDummyRowStep:"),console.log(`[printform]   heightPerPage: ${e}px, currentHeight: ${t}px`),console.log(`[printform]   remaining: ${i}px`)),i>0?(ce(r,o,i),a&&console.log(`[printform]   inserted 1 dummy_row with height: ${i}px`),m(t+i)):m(t)}function fe(r,o,e,t,a,i){if(!r.insertFooterSpacerWithDummyRowItemWhileFormatTable||a)return i&&console.log(`[printform] applyFooterSpacerWithDummyStep: SKIPPED (flag=${r.insertFooterSpacerWithDummyRowItemWhileFormatTable}, skipDummy=${a})`),{currentHeight:m(t),skipFooterSpacer:!1};const n=m(e-t);let s=m(t);if(i&&(console.log("[printform] applyFooterSpacerWithDummyStep:"),console.log(`[printform]   heightPerPage: ${e}px, currentHeight: ${t}px`),console.log(`[printform]   remaining: ${n}px`)),n>0){B(r,o,n);const l=m(r.heightOfDummyRowItem);if(l>0){const p=Math.floor(n/l),c=m(n%l);s=m(e-c),i&&console.log(`[printform]   inserted ${p} spacer dummy_row_items, remainder: ${c}px`)}}return{currentHeight:s,skipFooterSpacer:!0}}function ge(r,o,e,t,a,i,n){if(!r.insertFooterSpacerWhileFormatTable){n&&console.log("[printform] applyFooterSpacerStep: SKIPPED (insertFooterSpacerWhileFormatTable=false)");return}const s=i.cloneNode(!0);let l=m(e-t);const p=a&&a.nonRepeating?m(a.nonRepeating):0;p>0&&(l-=p);const c=Math.max(0,l);s.style.height=`${c}px`,o.appendChild(s),n&&(console.log("[printform] applyFooterSpacerStep:"),console.log(`[printform]   heightPerPage: ${e}px, currentHeight: ${t}px`),console.log(`[printform]   nonRepeatingFooter: ${p}px`),console.log(`[printform]   pfooter_spacer height: ${c}px`))}function me(r,o){!r||!o||r.classList.contains(`${o}_processed`)||(r.classList.remove(o),r.classList.add(`${o}_processed`))}function he(r){if(!r)return 0;const o=r.offsetHeight||r.getBoundingClientRect().height,e=r.ownerDocument&&r.ownerDocument.defaultView||(typeof window<"u"?window:null);if(!e||!e.getComputedStyle)return m(o);const t=e.getComputedStyle(r),a=Number.parseFloat(t.marginTop)||0,i=Number.parseFloat(t.marginBottom)||0;return m(o+a+i)}function ye(r){if(!r)return 0;const o=r.getBoundingClientRect?r.getBoundingClientRect():null,e=o&&Number.isFinite(o.height)?o.height:r.offsetHeight||0,t=r.ownerDocument&&r.ownerDocument.defaultView||(typeof window<"u"?window:null);if(!t||!t.getComputedStyle)return Number.isFinite(e)?Math.max(0,e):0;const a=t.getComputedStyle(r),i=Number.parseFloat(a.marginTop)||0,n=Number.parseFloat(a.marginBottom)||0,s=e+i+n;return Number.isFinite(s)?Math.max(0,s):0}function Pe(r){const o=document.createElement("div");o.classList.add("div_page_break_before"),o.setAttribute("style","page-break-before: always; font-size: 0pt; height: 0px;");const e=typeof window<"u"?window:globalThis,t=typeof r=="string"&&r.trim()?r:e&&typeof e.__printFormDividerClassAppend=="string"?e.__printFormDividerClassAppend:"";return t&&t.split(/\s+/).filter(Boolean).forEach(a=>o.classList.add(a)),o}function we(r,o,e,t){if(!o)return null;const a=o.cloneNode(!0);return r.appendChild(a),e&&e(`append ${t}`),a}function _e(r,o,e,t,a){if(!o)return null;const i=o.cloneNode(!0);return r.appendChild(i),e&&e(`append ${a||"prowitem"} ${t}`),i}const g={markAsProcessed:me,measureHeight:he,measureHeightRaw:ye,createPageBreakDivider:Pe,appendClone:we,appendRowItem:_e,createDummyRowTable:O};function be(r){r.prototype.initializeOutputContainer=function(){const e=document.createElement("div");return e.classList.add("printform_formatter"),this.formEl.parentNode.insertBefore(e,this.formEl),e},r.prototype.initializePhysicalWrapper=function(e){this.currentPhysicalWrapper?(e.appendChild(g.createPageBreakDivider()),this.currentPhysicalPage+=1):this.currentPhysicalPage=1;const t=document.createElement("div");return t.classList.add("physical_page_wrapper"),t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="flex-start",t.style.width=`${this.config.papersizeWidth}px`,e.appendChild(t),this.currentPhysicalWrapper=t,this.pagesInCurrentPhysical=0,t},r.prototype.ensureCurrentPageContainer=function(e){return this.currentPhysicalWrapper||this.initializePhysicalWrapper(e),this.currentPageContainer||this.createNewLogicalPage(e),this.currentPageContainer},r.prototype.createNewLogicalPage=function(e){(!this.currentPhysicalWrapper||this.pagesInCurrentPhysical>=this.nUp)&&this.initializePhysicalWrapper(e);const t=document.createElement("div");return t.classList.add("printform_page"),t.style.width=`${this.config.papersizeWidth}px`,this.currentPhysicalWrapper.appendChild(t),this.currentPageContainer=t,this.pagesInCurrentPhysical+=1,this.logicalPageToPhysicalPage[this.currentPage]=this.currentPhysicalPage,t},r.prototype.getCurrentPageContainer=function(e){return this.ensureCurrentPageContainer(e)},r.prototype.finalizePageHeight=function(e){if(!e)return;const t=this.config.papersizeHeight,a=this.config.fillPageHeightAfterFooter!==!1;let i=0;const n=s=>Number.isFinite(s)?String(Math.round(s*100)/100):"0";if(a){const s=g.measureHeightRaw(e),l=Math.max(0,t-s);if(l>.01){const p=document.createElement("div");p.classList.add("dummy_spacer"),p.setAttribute("aria-hidden","true"),p.style.display="block",p.style.width="100%",p.style.height=`${l}px`,p.style.margin="0",p.style.padding="0";const c=v.map(f=>`.${f.className}_processed`).concat([`.${D.className}_processed`,`.${L.className}_processed`]),d=e.querySelector(c.join(", "));d&&d.parentNode===e?e.insertBefore(p,d):e.appendChild(p),i=l}}if(this.debug){console.log(`
[printform] ========== PAGE HEIGHT CALCULATION ==========`),console.log(`[printform] Configured page height: ${t}px`),console.log("[printform] -------------------------------------------");const s=Array.from(e.children);let l=0;if(console.log(`[printform] Elements breakdown (${s.length} elements):`),s.forEach((p,c)=>{const d=g.measureHeightRaw(p);l+=d;const f=p.className||"(no class)",h=p.tagName.toLowerCase();console.log(`[printform]   ${c+1}. <${h}.${f}>`),console.log(`[printform]      Height: ${n(d)}px`),console.log(`[printform]      Cumulative: ${n(l)}px`),console.log(`[printform]      Remaining: ${n(Math.max(0,t-l))}px`),d>t*.5&&console.log("[printform]      ⚠️  WARNING: Element height is > 50% of page height")}),console.log("[printform] -------------------------------------------"),console.log(`[printform] Total content height: ${n(l)}px`),l<t){const p=t-l;console.log(`[printform] ✓ Content fits (${n(p)}px under limit)`)}else if(l>t){const p=l-t;console.log(`[printform] ⚠️  Content overflow (${n(p)}px over limit)`)}else console.log("[printform] ✓ Perfect fit (exactly matches configured height)");i>0&&console.log(`[printform] ✓ Final spacer appended: ${n(i)}px`)}if(this.debug){const s=g.measureHeightRaw(e);console.log("[printform] -------------------------------------------"),console.log(`[printform] Actual measured height: ${n(s)}px`),console.log("[printform] ℹ️  Height NOT set - using natural content height"),console.log(`[printform] ===============================================
`)}}}const Se=".prowitem, .ptac-rowitem, .paddt-rowitem",He=200,Re=200;function Ne(r){var o=[];if(!r||!r.ownerDocument||!r.ownerDocument.createTreeWalker)return o;for(var e=r.ownerDocument.createTreeWalker(r,4,null,!1),t=e.nextNode();t;){for(var a=t.nodeValue||"",i=/\S+/g,n=i.exec(a);n;)o.push({node:t,start:n.index,end:n.index+n[0].length}),n=i.exec(a);t=e.nextNode()}return o}function Fe(r,o){var e=r.cloneNode(!1);return e.appendChild(o.cloneContents()),e.outerHTML||""}function q(r,o){if(!r)return[];if(!o||o<=0)return[r.outerHTML||""];var e=(r.textContent||"").trim();if(!e)return[r.outerHTML||""];if(!r.ownerDocument||!r.ownerDocument.createRange||!r.ownerDocument.createTreeWalker)return[r.outerHTML||""];var t=Ne(r);if(t.length===0)return[r.outerHTML||""];if(t.length<=o)return[r.outerHTML||""];for(var a=[],i=0;i<t.length;i+=o){var n=i+o-1;n>=t.length&&(n=t.length-1);var s=r.ownerDocument.createRange();if(i===0)s.setStart(r,0);else{var l=t[i];s.setStart(l.node,l.start)}if(n+1<t.length){var p=t[n+1];s.setEnd(p.node,p.start)}else s.setEnd(r,r.childNodes.length);a.push(Fe(r,s))}return a}function Ce(r,o){return q(r,o)}function De(r){r.prototype.collectSections=function(){this.expandPaddtSegments(),this.expandPtacSegments();const e=re.map(s=>{const l=this.formEl.querySelector(`.${s.className}`);return l?{key:s.key,className:s.className,repeatFlag:s.repeatFlag,element:l}:null}).filter(Boolean),t=v.map(s=>{const l=this.formEl.querySelector(`.${s.className}`);return l?{key:s.key,className:s.className,repeatFlag:s.repeatFlag,element:l}:null}).filter(Boolean),a=Array.from(this.formEl.querySelectorAll(Se)),i=a.filter(s=>this.isPaddtRow(s)),n=a.filter(s=>!this.isPaddtRow(s));return this.paddtRows=i,{header:this.formEl.querySelector(".pheader"),docInfos:e,rowHeader:this.formEl.querySelector(".prowheader"),footerVariants:t,footerLogo:this.formEl.querySelector(`.${D.className}`),footerPagenum:this.formEl.querySelector(`.${L.className}`),rows:n}},r.prototype.measureSections=function(e){const t={header:g.measureHeight(e.header),docInfos:{},rowHeader:g.measureHeight(e.rowHeader),footerVariants:{},footerLogo:g.measureHeight(e.footerLogo),footerPagenum:g.measureHeight(e.footerPagenum)};return e.docInfos.forEach(a=>{t.docInfos[a.key]=g.measureHeight(a.element)}),e.footerVariants.forEach(a=>{t.footerVariants[a.key]=g.measureHeight(a.element)}),t},r.prototype.markSectionsProcessed=function(e){g.markAsProcessed(e.header,"pheader"),e.docInfos.forEach(t=>{g.markAsProcessed(t.element,t.className)}),g.markAsProcessed(e.rowHeader,"prowheader"),e.footerVariants.forEach(t=>{g.markAsProcessed(t.element,t.className)}),g.markAsProcessed(e.footerLogo,D.className),g.markAsProcessed(e.footerPagenum,L.className)},r.prototype.createFooterSpacerTemplate=function(){const e=document.createElement("div");return e.classList.add("pfooter_spacer","paper_width"),e.style.height="0px",e}}function ke(r){r.prototype.isPaddtRow=function(e){return e?e.classList.contains("paddt_segment")||e.classList.contains("paddt")||e.classList.contains("paddt-rowitem")||e.classList.contains("paddt-rowitem_processed"):!1},r.prototype.isPtacRow=function(e){return e?e.classList.contains("ptac_segment")||e.classList.contains("ptac")||e.classList.contains("ptac-rowitem")||e.classList.contains("ptac-rowitem_processed"):!1},r.prototype.getRowBaseClass=function(e){return e?this.isPaddtRow(e)?"paddt-rowitem":this.isPtacRow(e)?"ptac-rowitem":"prowitem":"prowitem"},r.prototype.shouldSkipRowHeaderForRow=function(e){return!e||!this.config.repeatRowheader?!1:e.classList.contains("without_prowheader")||e.classList.contains("tb_without_rowheader")?!0:this.isPtacRow(e)?!this.config.repeatPtacRowheader:this.isPaddtRow(e)?!(this.paddtConfig&&this.paddtConfig.repeatPaddtRowheader):!1},r.prototype.shouldSkipDummyRowItemsForContext=function(e){return!!(e&&(e.isPtacPage&&!this.config.insertPtacDummyRowItems||e.isPaddtPage&&!(this.paddtConfig&&this.paddtConfig.insertPaddtDummyRowItems)))}}function Le(r){r.prototype.expandPaddtSegments=function(){if(this.formEl.dataset.paddtExpanded==="true")return;const e=Array.from(this.formEl.querySelectorAll(".paddt"));if(e.length===0){this.formEl.dataset.paddtExpanded="true";return}var t=this.paddtConfig&&this.paddtConfig.paddtMaxWordsPerSegment||Re;e.forEach(a=>{if(!a||a.dataset.paddtSegment==="true")return;const i=a.querySelector("td > div")||a.querySelector("td");if(!i){a.classList.add("paddt-rowitem","paddt_segment"),a.dataset.paddtSegment="true";return}const n=Array.from(i.children);if(n.length===0){a.classList.add("paddt-rowitem","paddt_segment"),a.dataset.paddtSegment="true";return}const s=[];if(n.forEach(c=>{c.tagName.toLowerCase()==="p"?Ce(c,t).forEach(f=>s.push(f)):s.push(c.outerHTML)}),s.length===0){a.classList.add("paddt-rowitem","paddt_segment"),a.dataset.paddtSegment="true";return}i.innerHTML=s[0],a.classList.add("paddt-rowitem","paddt_segment"),a.dataset.paddtSegment="true";for(var l=a,p=1;p<s.length;p+=1){const c=a.cloneNode(!0);c.dataset.paddtSegment="true";const d=c.querySelector("td > div")||c.querySelector("td");d&&(d.innerHTML=s[p]),l.parentNode.insertBefore(c,l.nextSibling),l=c}}),this.formEl.dataset.paddtExpanded="true"}}function Ee(r){r.prototype.expandPtacSegments=function(){if(this.formEl.dataset.ptacExpanded==="true")return;const e=Array.from(this.formEl.querySelectorAll(".ptac"));if(e.length===0){this.formEl.dataset.ptacExpanded="true";return}e.forEach(t=>{if(!t||t.dataset.ptacSegment==="true")return;const a=t.querySelector("td > div")||t.querySelector("td");if(!a){t.classList.add("ptac-rowitem","ptac_segment"),t.dataset.ptacSegment="true";return}const i=Array.from(a.children);if(i.length===0){t.classList.add("ptac-rowitem","ptac_segment"),t.dataset.ptacSegment="true";return}const n=[];if(i.forEach(p=>{p.tagName.toLowerCase()==="p"?q(p,He).forEach(d=>n.push(d)):n.push(p.outerHTML)}),n.length===0){t.classList.add("ptac-rowitem","ptac_segment"),t.dataset.ptacSegment="true";return}a.innerHTML=n[0],t.classList.add("ptac-rowitem","ptac_segment"),t.dataset.ptacSegment="true";for(var s=t,l=1;l<n.length;l+=1){const p=t.cloneNode(!0);p.classList.remove("tb_page_break_before"),p.dataset.ptacSegment="true";const c=p.querySelector("td > div")||p.querySelector("td");c&&(c.innerHTML=n[l]),s.parentNode.insertBefore(p,s.nextSibling),s=p}}),this.formEl.dataset.ptacExpanded="true"}}function xe(r){r.prototype.ensureFirstPageSections=function(e,t,a,i,n){let s=0;return t.header&&(g.appendClone(e,t.header,i,"pheader"),this.config.repeatHeader||(s+=a.header)),t.docInfos.forEach(l=>{const p=g.appendClone(e,l.element,i,l.className);this.registerPageNumberClone(p),this.config[l.repeatFlag]||(s+=a.docInfos[l.key]||0)}),t.rowHeader&&!n&&(g.appendClone(e,t.rowHeader,i,"prowheader"),this.config.repeatRowheader||(s+=a.rowHeader)),s},r.prototype.appendRepeatingSections=function(e,t,a,i){this.config.repeatHeader&&g.appendClone(e,t.header,a,"pheader"),t.docInfos.forEach(n=>{if(this.config[n.repeatFlag]){const s=g.appendClone(e,n.element,a,n.className);this.registerPageNumberClone(s)}}),this.config.repeatRowheader&&!i&&g.appendClone(e,t.rowHeader,a,"prowheader")},r.prototype.registerPageNumberClone=function(e){if(!e)return!1;let t=!1;if(this.showLogicalPageNumber&&e.querySelector("[data-page-number], [data-page-total], [data-page-number-container]")&&(I(e,this.currentPage,null),this.logicalPageNumberClones.push({node:e,pageNumber:this.currentPage}),t=!0),this.showPhysicalPageNumber&&e.querySelector("[data-physical-page-number], [data-physical-page-total], [data-physical-page-number-container]")){const a=this.logicalPageToPhysicalPage[this.currentPage]||this.currentPhysicalPage||1;V(e,a,null),this.physicalPageNumberClones.push({node:e,pageNumber:a}),t=!0}return t},r.prototype.appendRepeatingFooters=function(e,t,a){t.footerVariants.forEach(i=>{this.config[i.repeatFlag]&&g.appendClone(e,i.element,a,i.className)}),this.config.repeatFooterLogo&&g.appendClone(e,t.footerLogo,a,D.className),this.config.repeatFooterPagenum&&this.appendFooterPageNumber(e,t,a)},r.prototype.appendFinalFooters=function(e,t,a){t.footerVariants.forEach(i=>{g.appendClone(e,i.element,a,i.className)}),g.appendClone(e,t.footerLogo,a,D.className),this.appendFooterPageNumber(e,t,a)},r.prototype.appendFooterPageNumber=function(e,t,a){if(!t.footerPagenum)return;const i=t.footerPagenum.cloneNode(!0);e.appendChild(i),this.registerPageNumberClone(i),a&&a(`append ${L.className} page ${this.currentPage}`)},r.prototype.updatePageNumberTotals=function(){if(!this.logicalPageNumberClones.length&&!this.physicalPageNumberClones.length)return;const e=this.currentPage,t=this.currentPhysicalPage||1;this.logicalPageNumberClones.forEach(a=>{I(a.node,a.pageNumber,e)}),this.physicalPageNumberClones.forEach(a=>{V(a.node,a.pageNumber,t)})}}function $e(r){r.prototype.initializePageContext=function(e){return{baseLimit:e,limit:e,skipRowHeader:!1,isPtacPage:!1,isPaddtPage:!1,repeatingHeight:0}},r.prototype.refreshPageContextForRow=function(e,t,a){if(!e)return e;const i=this.shouldSkipRowHeaderForRow(t),n=a.rowHeader||0;return e.skipRowHeader=i,e.isPtacPage=this.isPtacRow(t),e.isPaddtPage=this.isPaddtRow(t),e.limit=e.baseLimit+(i?n:0),e},r.prototype.computeRepeatingHeightForPage=function(e,t,a){let i=0;return this.config.repeatHeader&&e.header&&(i+=t.header||0),e.docInfos.forEach(n=>{this.config[n.repeatFlag]&&(i+=t.docInfos[n.key]||0)}),this.config.repeatRowheader&&e.rowHeader&&!a&&(i+=t.rowHeader||0),m(i)},r.prototype.measureContentHeight=function(e,t){const a=g.measureHeight(e);return m(a-(t||0))},r.prototype.renderRows=function(e,t,a,i,n,s,l){let p=0;const c=this.initializePageContext(n);return this.debug&&(console.log("[printform] ===== renderRows START ====="),console.log(`[printform] Total rows: ${t.rows.length}, heightPerPage: ${n}px`)),t.rows.forEach((d,f)=>{const h=g.measureHeight(d),y=this.getRowBaseClass(d),R=this.isPtacRow(d),F=this.isPaddtRow(d);if(!h){g.markAsProcessed(d,y);return}if(p===0){this.refreshPageContextForRow(c,d,a);const P=this.getCurrentPageContainer(e);this.ensureFirstPageSections(P,t,a,l,c.skipRowHeader),c.repeatingHeight=this.computeRepeatingHeightForPage(t,a,c.skipRowHeader),p=this.measureContentHeight(P,c.repeatingHeight),this.debug&&console.log(`[printform] Page ${this.currentPage} start: firstSectionHeight=${p}px, pageLimit=${c.limit}px`)}if(g.markAsProcessed(d,y),d.classList.contains("tb_page_break_before")){this.debug&&console.log(`[printform]   >> PAGE BREAK (tb_page_break_before) at row[${f}]`);const P=this.shouldSkipDummyRowItemsForContext(c),k=this.shouldSkipRowHeaderForRow(d);p=this.prepareNextPage(e,t,l,c.limit,p,i,s,k,P,c.repeatingHeight),this.refreshPageContextForRow(c,d,a);const S=this.getCurrentPageContainer(e);c.repeatingHeight=this.computeRepeatingHeightForPage(t,a,c.skipRowHeader),p=this.measureContentHeight(S,c.repeatingHeight),g.appendRowItem(S,d,null,f,y),l&&l(`append ${y||"prowitem"} ${f}`),p=this.measureContentHeight(S,c.repeatingHeight),this.debug&&console.log(`[printform] Page ${this.currentPage} start: currentHeight=${p}px, limit=${c.limit}px`),R||(c.isPtacPage=!1),F||(c.isPaddtPage=!1)}else{const P=this.getCurrentPageContainer(e),k=p,S=g.appendRowItem(P,d,null,f,y),E=this.measureContentHeight(P,c.repeatingHeight);if(this.debug&&console.log(`[printform]   row[${f}] height=${h}px, currentHeight=${E}px, limit=${c.limit}px`),E<=c.limit){l&&l(`append ${y||"prowitem"} ${f}`),p=E,R||(c.isPtacPage=!1),F||(c.isPaddtPage=!1);return}S&&S.parentNode===P&&P.removeChild(S),this.debug&&console.log(`[printform]   >> PAGE BREAK (overflow) at row[${f}]`);const Ie=this.shouldSkipDummyRowItemsForContext(c),Ve=this.shouldSkipRowHeaderForRow(d);p=this.prepareNextPage(e,t,l,c.limit,k,i,s,Ve,Ie,c.repeatingHeight),this.refreshPageContextForRow(c,d,a);const K=this.getCurrentPageContainer(e);c.repeatingHeight=this.computeRepeatingHeightForPage(t,a,c.skipRowHeader),p=this.measureContentHeight(K,c.repeatingHeight),g.appendRowItem(K,d,null,f,y),l&&l(`append ${y||"prowitem"} ${f}`),p=this.measureContentHeight(K,c.repeatingHeight),this.debug&&console.log(`[printform] Page ${this.currentPage} start: currentHeight=${p}px, limit=${c.limit}px`),R||(c.isPtacPage=!1),F||(c.isPaddtPage=!1)}}),this.debug&&console.log(`[printform] ===== renderRows END (page ${this.currentPage}, finalHeight=${p}px) =====`),{currentHeight:p,pageLimit:c.limit,isPtacPage:c.isPtacPage,isPaddtPage:c.isPaddtPage,repeatingHeight:c.repeatingHeight}},r.prototype.prepareNextPage=function(e,t,a,i,n,s,l,p,c,d){const f=this.getCurrentPageContainer(e),h=this.applyRemainderSpacing(f,i,n,s,l,{skipDummyRowItems:c,repeatingHeight:d});this.appendRepeatingFooters(f,t,a),this.currentPage+=1,this.currentPageContainer=null,this.createNewLogicalPage(e);const y=this.getCurrentPageContainer(e);return this.appendRepeatingSections(y,t,a,p),h},r.prototype.applyRemainderSpacing=function(e,t,a,i,n,s){const l=s&&s.skipDummyRowItems,p=s&&Number.isFinite(s.repeatingHeight)?s.repeatingHeight:null,c=s&&s.useCurrentHeight===!0;let d=m(a);if(p!==null&&!c){const h=g.measureHeight(e);d=m(h-p)}this.debug&&(console.log(`[printform] ----- applyRemainderSpacing (page ${this.currentPage}) -----`),console.log(`[printform]   heightPerPage: ${t}px, currentHeight: ${a}px`),console.log(`[printform]   skipDummyRowItems: ${l}`)),l||(d=de(this.config,e,t,d,this.debug)),d=ue(this.config,e,t,d,this.debug);const f=fe(this.config,e,t,d,l,this.debug);return d=f.currentHeight,f.skipFooterSpacer||ge(this.config,e,t,d,i,n,this.debug),this.debug&&(console.log(`[printform]   finalHeight after spacing: ${d}px`),console.log("[printform] -----------------------------------------")),m(d)}}function Te(r){r.prototype.computeHeightPerPage=function(e,t){let a=this.config.papersizeHeight;if(this.debug&&(console.log("[printform] ===== computeHeightPerPage ====="),console.log(`[printform] papersizeHeight (config): ${this.config.papersizeHeight}px`),console.log(`[printform] papersizeWidth (config): ${this.config.papersizeWidth}px`)),this.config.repeatHeader&&e.header&&(this.debug&&console.log(`[printform]   - repeatHeader: ${t.header}px`),a-=t.header),e.docInfos.forEach(i=>{if(this.config[i.repeatFlag]){const n=t.docInfos[i.key]||0;this.debug&&console.log(`[printform]   - repeat ${i.className}: ${n}px`),a-=n}}),this.config.repeatRowheader&&e.rowHeader&&(this.debug&&console.log(`[printform]   - repeatRowheader: ${t.rowHeader}px`),a-=t.rowHeader),e.footerVariants.forEach(i=>{if(this.config[i.repeatFlag]){const n=t.footerVariants[i.key]||0;this.debug&&console.log(`[printform]   - repeat ${i.className}: ${n}px`),a-=n}}),this.config.repeatFooterLogo&&e.footerLogo&&(this.debug&&console.log(`[printform]   - repeatFooterLogo: ${t.footerLogo}px`),a-=t.footerLogo),this.config.repeatFooterPagenum&&e.footerPagenum){const i=t.footerPagenum||0;this.debug&&console.log(`[printform]   - repeatFooterPagenum: ${i}px`),a-=i}return this.debug&&(console.log(`[printform] heightPerPage (available for content): ${Math.max(0,a)}px`),console.log("[printform] ================================")),Math.max(0,a)},r.prototype.computeFooterState=function(e,t){const a=t.footerLogo||0,i=t.footerPagenum||0,s=e.footerVariants.reduce((d,f)=>{const h=t.footerVariants[f.key]||0;return d+h},0)+a+i;let p=e.footerVariants.reduce((d,f)=>{const h=t.footerVariants[f.key]||0;return this.config[f.repeatFlag]?d+h:d},0);this.config.repeatFooterLogo&&(p+=a),this.config.repeatFooterPagenum&&(p+=i);const c=Math.max(0,s-p);return{totalFinal:s,repeating:p,nonRepeating:c}},r.prototype.finalizeDocument=function(e,t,a,i,n,s,l,p){const c=s?s.currentHeight:0,d=s&&s.pageLimit?s.pageLimit:n,f=s&&Number.isFinite(s.repeatingHeight)?s.repeatingHeight:0,h=!!(s&&(s.isPtacPage&&!this.config.insertPtacDummyRowItems||s.isPaddtPage&&!(this.paddtConfig&&this.paddtConfig.insertPaddtDummyRowItems))),y=i.totalFinal-i.repeating,R=c+y;if(R<=d){const S=this.getCurrentPageContainer(e);this.applyRemainderSpacing(S,d,R,i,l,{skipDummyRowItems:h,repeatingHeight:f,useCurrentHeight:!0}),this.appendFinalFooters(S,t,p);return}this.prepareNextPage(e,t,p,d,c,i,l,!1,h,f);const F=y,P=this.getCurrentPageContainer(e),k=this.computeRepeatingHeightForPage(t,a,!1);this.applyRemainderSpacing(P,n,F,i,l,{repeatingHeight:k,useCurrentHeight:!0}),this.appendFinalFooters(P,t,p)}}class b{constructor(o,e){this.formEl=o,this.config=e,this.debug=!!e.debug,this.nUp=Math.max(1,Math.floor(Number(e.nUp||1))),this.showLogicalPageNumber=e.showLogicalPageNumber!==!1,this.showPhysicalPageNumber=!!e.showPhysicalPageNumber,this.paddtConfig=pe(o,{}),this.paddtDebug=!!this.paddtConfig.paddtDebug,this.currentPage=1,this.currentPhysicalPage=0,this.pagesInCurrentPhysical=0,this.currentPhysicalWrapper=null,this.currentPageContainer=null,this.logicalPageNumberClones=[],this.physicalPageNumberClones=[],this.logicalPageToPhysicalPage=[],this.debug&&(console.log("[printform] ===== PrintFormFormatter initialized ====="),console.log("[printform] debug mode: ON"),console.log(`[printform] config.debug raw value: ${e.debug}`))}log(o){this.debug&&console.log(`[printform] ${o}`)}format(){const o=this.debug?this.log.bind(this):null,e=this.initializeOutputContainer();this.ensureCurrentPageContainer(e);const t=this.collectSections(),a=this.measureSections(t),i=this.createFooterSpacerTemplate();this.markSectionsProcessed(t);const n=this.computeFooterState(t,a),s=this.computeHeightPerPage(t,a),l=this.renderRows(e,t,a,n,s,i,o);if(this.finalizeDocument(e,t,a,n,s,l,i,o),this.paddtRows&&this.paddtRows.length){this.currentPage+=1,this.currentPageContainer=null,this.initializePhysicalWrapper(e),this.createNewLogicalPage(e);var p={docInfo:this.paddtConfig.repeatPaddtDocinfo,docInfo002:this.paddtConfig.repeatPaddtDocinfo002,docInfo003:this.paddtConfig.repeatPaddtDocinfo003,docInfo004:this.paddtConfig.repeatPaddtDocinfo004,docInfo005:this.paddtConfig.repeatPaddtDocinfo005},c=t.docInfos.filter(function(F){var P=p[F.key];return P===void 0?!0:!!P});const f={header:t.header,docInfos:c,rowHeader:t.rowHeader,footerVariants:[],footerLogo:t.footerLogo,footerPagenum:t.footerPagenum,rows:this.paddtRows},h=this.computeFooterState(f,a),y=this.computeHeightPerPage(f,a),R=this.renderRows(e,f,a,h,y,i,o);this.finalizeDocument(e,f,a,h,y,R,i,o)}this.updatePageNumberTotals();const d=e.querySelectorAll(".printform_page");return this.debug&&console.log(`[printform] Finalizing heights for ${d.length} pages...`),d.forEach((f,h)=>{if(this.finalizePageHeight(f),this.debug){const y=f.style.height||"(auto)";console.log(`[printform]   Page ${h+1}: height style = ${y}`)}}),e.classList.remove("printform_formatter"),e.classList.add("printform_formatter_processed"),this.formEl.remove(),e}}be(b),De(b),ke(b),Le(b),Ee(b),xe(b),$e(b),Te(b);function U(r,o,e){const t=r.__printFormDividerClassAppend;r.__printFormDividerClassAppend=typeof o=="string"?o:"";try{return e()}finally{t===void 0?delete r.__printFormDividerClassAppend:r.__printFormDividerClassAppend=t}}function Ke(r){return new Promise((o,e)=>{setTimeout(o,r)})}async function G(r={}){const o=typeof window<"u"?window:globalThis;if(!o.__printFormProcessing&&!(!r.force&&o.__printFormProcessed)){o.__printFormProcessing=!0;try{const e=o.document;if(!e)return;const t=Array.from(e.querySelectorAll(".printform"));for(let a=0;a<t.length;a+=1){const i=t[a],n={...r};if(n.divPageBreakBeforeClassAppend===void 0&&i&&i.dataset){const p=i.dataset.divPageBreakBeforeClassAppend;typeof p=="string"&&p.trim()&&(n.divPageBreakBeforeClassAppend=p.trim())}const s=n.divPageBreakBeforeClassAppend,l=z(i,n);try{await Ke(1)}catch(p){console.error("pauseInMilliseconds error",p)}try{const p=U(o,s,()=>new b(i,l).format());a>0&&p&&p.parentNode&&p.parentNode.insertBefore(g.createPageBreakDivider(s),p)}catch(p){console.error("printform format error",p)}}o.__printFormProcessed=!0}finally{o.__printFormProcessing=!1}}}function Ae(r,o={}){const e=typeof window<"u"?window:globalThis,t={...o};if(t.divPageBreakBeforeClassAppend===void 0&&r&&r.dataset){const n=r.dataset.divPageBreakBeforeClassAppend;typeof n=="string"&&n.trim()&&(t.divPageBreakBeforeClassAppend=n.trim())}const a=t.divPageBreakBeforeClassAppend,i=z(r,t);return U(e,a,()=>new b(r,i).format())}const T={formatAll:G,format:Ae,DEFAULT_CONFIG:w,DEFAULT_PADDT_CONFIG:N},H=typeof window<"u"?window:null;if(H)if(H.__printFormScriptLoaded__)H.PrintForm=H.PrintForm||T;else{H.__printFormScriptLoaded__=!0,H.PrintForm=H.PrintForm||{},Object.assign(H.PrintForm,T);const r=H.document;r&&r.addEventListener&&r.addEventListener("DOMContentLoaded",()=>{G()})}return T}();
