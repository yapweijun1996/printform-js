var PrintForm=function(){"use strict";const v=new Set(["y","yes","true","1"]),U=new Set(["n","no","false","0"]);function p(o,e){if(o==null||o==="")return e;if(typeof o=="boolean")return o;if(typeof o=="number")return o!==0;const t=String(o).trim().toLowerCase();return v.has(t)?!0:U.has(t)?!1:e}function b(o,e){if(o==null||o==="")return e;const t=Number(o);return Number.isFinite(t)?t:e}function F(o,e){return o==null||o===""?e:String(o)}function B(o){const e=String(o||"").trim().toLowerCase();return e==="landscape"?"landscape":e==="portrait"?"portrait":""}function $(o){const e=String(o||"").trim();if(!e)return"";const t=e.toUpperCase();return t==="A4"||t==="A5"||t==="LETTER"||t==="LEGAL"?t:t==="US_LETTER"||t==="USLETTER"?"LETTER":t==="US_LEGAL"||t==="USLEGAL"?"LEGAL":""}function K(o,e){const t=Number(o),a=Number(e);return!Number.isFinite(t)||!Number.isFinite(a)||a<=0?0:Math.round(t/25.4*a)}const j={A4:{widthMm:210,heightMm:297},A5:{widthMm:148,heightMm:210},LETTER:{widthMm:215.9,heightMm:279.4},LEGAL:{widthMm:215.9,heightMm:355.6}};function G(o){const e=$(o&&o.paperSize);if(!e)return null;const t=j[e];if(!t)return null;const a=Number(o&&o.dpi),r=K(t.widthMm,a),i=K(t.heightMm,a);return!r||!i?null:(B(o&&o.orientation)||"portrait")==="landscape"?{width:i,height:r}:{width:r,height:i}}function f(o){const e=Number(o);return Number.isFinite(e)?Math.max(0,Math.round(e)):0}function X(o){if(!o)return null;if(o.__pageNumberPlaceholder)return o.__pageNumberPlaceholder;const e=o.ownerDocument||(typeof document<"u"?document:null);if(!e)return null;let t=o.querySelector("[data-page-number-container]");t||(t=o.querySelector("td:last-child")||o.querySelector("td")||o);const a=e.createElement("span");return a.className="printform_page_number_placeholder",t.appendChild(a),o.__pageNumberPlaceholder=a,a}function Z(o){if(!o)return null;if(o.__physicalPageNumberPlaceholder)return o.__physicalPageNumberPlaceholder;const e=o.ownerDocument||(typeof document<"u"?document:null);if(!e)return null;let t=o.querySelector("[data-physical-page-number-container]");t||(t=o.querySelector("td:last-child")||o.querySelector("td")||o);const a=e.createElement("span");return a.className="printform_physical_page_number_placeholder",t.appendChild(a),o.__physicalPageNumberPlaceholder=a,a}function T(o,e,t){if(!o)return;const a=o.querySelectorAll("[data-page-number]");a.length>0&&a.forEach(function(n){n.textContent=e});const r=o.querySelectorAll("[data-page-total]"),i=t??"";if(r.length>0&&r.forEach(function(n){n.textContent=i}),a.length===0&&r.length===0){const n=X(o);n&&(n.textContent=t!=null?"Page "+e+" of "+t:"Page "+e)}}function I(o,e,t){if(!o)return;const a=o.querySelectorAll("[data-physical-page-number]");a.length>0&&a.forEach(function(n){n.textContent=e});const r=o.querySelectorAll("[data-physical-page-total]"),i=t??"";if(r.length>0&&r.forEach(function(n){n.textContent=i}),a.length===0&&r.length===0){const n=Z(o);n&&(n.textContent=t!=null?"Sheet "+e+" of "+t:"Sheet "+e)}}const R=[{key:"papersizeWidth",datasetKey:"papersizeWidth",legacyKey:"papersize_width",defaultValue:750,parser:b},{key:"papersizeHeight",datasetKey:"papersizeHeight",legacyKey:"papersize_height",defaultValue:1050,parser:b},{key:"paperSize",datasetKey:"paperSize",legacyKey:"paper_size",defaultValue:"",parser:F},{key:"orientation",datasetKey:"orientation",legacyKey:"orientation",defaultValue:"portrait",parser:F},{key:"dpi",datasetKey:"dpi",legacyKey:"dpi",defaultValue:96,parser:b},{key:"nUp",datasetKey:"nUp",legacyKey:"n_up",defaultValue:1,parser:b},{key:"showLogicalPageNumber",datasetKey:"showLogicalPageNumber",legacyKey:"show_logical_page_number",defaultValue:!0,parser:p},{key:"showPhysicalPageNumber",datasetKey:"showPhysicalPageNumber",legacyKey:"show_physical_page_number",defaultValue:!1,parser:p},{key:"heightOfDummyRowItem",datasetKey:"heightOfDummyRowItem",legacyKey:"height_of_dummy_row_item",defaultValue:18,parser:b},{key:"repeatHeader",datasetKey:"repeatHeader",legacyKey:"repeat_header",defaultValue:!0,parser:p},{key:"repeatDocinfo",datasetKey:"repeatDocinfo",legacyKey:"repeat_docinfo",defaultValue:!0,parser:p},{key:"repeatDocinfo002",datasetKey:"repeatDocinfo002",legacyKey:"repeat_docinfo002",defaultValue:!0,parser:p},{key:"repeatDocinfo003",datasetKey:"repeatDocinfo003",legacyKey:"repeat_docinfo003",defaultValue:!0,parser:p},{key:"repeatDocinfo004",datasetKey:"repeatDocinfo004",legacyKey:"repeat_docinfo004",defaultValue:!0,parser:p},{key:"repeatDocinfo005",datasetKey:"repeatDocinfo005",legacyKey:"repeat_docinfo005",defaultValue:!0,parser:p},{key:"repeatRowheader",datasetKey:"repeatRowheader",legacyKey:"repeat_rowheader",defaultValue:!0,parser:p},{key:"repeatPtacRowheader",datasetKey:"repeatPtacRowheader",legacyKey:"repeat_ptac_rowheader",defaultValue:!0,parser:p},{key:"repeatFooter",datasetKey:"repeatFooter",legacyKey:"repeat_footer",defaultValue:!1,parser:p},{key:"repeatFooter002",datasetKey:"repeatFooter002",legacyKey:"repeat_footer002",defaultValue:!1,parser:p},{key:"repeatFooter003",datasetKey:"repeatFooter003",legacyKey:"repeat_footer003",defaultValue:!1,parser:p},{key:"repeatFooter004",datasetKey:"repeatFooter004",legacyKey:"repeat_footer004",defaultValue:!1,parser:p},{key:"repeatFooter005",datasetKey:"repeatFooter005",legacyKey:"repeat_footer005",defaultValue:!1,parser:p},{key:"repeatFooterLogo",datasetKey:"repeatFooterLogo",legacyKey:"repeat_footer_logo",defaultValue:!1,parser:p},{key:"repeatFooterPagenum",datasetKey:"repeatFooterPagenum",legacyKey:"repeat_footer_pagenum",defaultValue:!1,parser:p},{key:"insertDummyRowItemWhileFormatTable",datasetKey:"insertDummyRowItemWhileFormatTable",legacyKey:"insert_dummy_row_item_while_format_table",defaultValue:!0,parser:p},{key:"insertPtacDummyRowItems",datasetKey:"insertPtacDummyRowItems",legacyKey:"insert_ptac_dummy_row_items",defaultValue:!0,parser:p},{key:"insertDummyRowWhileFormatTable",datasetKey:"insertDummyRowWhileFormatTable",legacyKey:"insert_dummy_row_while_format_table",defaultValue:!1,parser:p},{key:"insertFooterSpacerWhileFormatTable",datasetKey:"insertFooterSpacerWhileFormatTable",legacyKey:"insert_footer_spacer_while_format_table",defaultValue:!0,parser:p},{key:"insertFooterSpacerWithDummyRowItemWhileFormatTable",datasetKey:"insertFooterSpacerWithDummyRowItemWhileFormatTable",legacyKey:"insert_footer_spacer_with_dummy_row_item_while_format_table",defaultValue:!0,parser:p},{key:"customDummyRowItemContent",datasetKey:"customDummyRowItemContent",legacyKey:"custom_dummy_row_item_content",defaultValue:"",parser:F},{key:"debug",datasetKey:"debug",legacyKey:"debug_printform",defaultValue:!1,parser:p}],J=[{key:"docInfo",className:"pdocinfo",repeatFlag:"repeatDocinfo"},{key:"docInfo002",className:"pdocinfo002",repeatFlag:"repeatDocinfo002"},{key:"docInfo003",className:"pdocinfo003",repeatFlag:"repeatDocinfo003"},{key:"docInfo004",className:"pdocinfo004",repeatFlag:"repeatDocinfo004"},{key:"docInfo005",className:"pdocinfo005",repeatFlag:"repeatDocinfo005"}],Q=[{key:"footer",className:"pfooter",repeatFlag:"repeatFooter"},{key:"footer002",className:"pfooter002",repeatFlag:"repeatFooter002"},{key:"footer003",className:"pfooter003",repeatFlag:"repeatFooter003"},{key:"footer004",className:"pfooter004",repeatFlag:"repeatFooter004"},{key:"footer005",className:"pfooter005",repeatFlag:"repeatFooter005"}],L={className:"pfooter_logo"},D={className:"pfooter_pagenum"},_=R.reduce((o,e)=>(o[e.key]=e.defaultValue,o),{});function V(o){const e=typeof window<"u"?window:typeof globalThis<"u"?globalThis:{};return o.reduce((t,a)=>{if(!a.legacyKey)return t;const r=e[a.legacyKey];return r==null||r===""||(t[a.key]=a.parser(r,a.defaultValue)),t},{})}function M(o,e){const t=e||{};return o.reduce((a,r)=>{if(!r.datasetKey||!Object.prototype.hasOwnProperty.call(t,r.datasetKey))return a;const i=t[r.datasetKey];return i==null||i===""||(a[r.key]=r.parser(i,r.defaultValue)),a},{})}function Y(){return V(R)}function ee(o){return M(R,o)}function te(o,e){const t=o.querySelector("template.custom-dummy-row-item-content");return t?t.innerHTML.trim():e}function W(o,e={}){const t=Y(),a=ee(o.dataset||{}),r={..._,...t,...a,...e};r.customDummyRowItemContent=te(o,e.customDummyRowItemContent!==void 0?e.customDummyRowItemContent:r.customDummyRowItemContent),r.debug=p(r.debug,_.debug),r.nUp=b(r.nUp,_.nUp),(!Number.isFinite(r.nUp)||r.nUp<1)&&(r.nUp=_.nUp),r.nUp=Math.floor(r.nUp),r.showLogicalPageNumber=p(r.showLogicalPageNumber,_.showLogicalPageNumber),r.showPhysicalPageNumber=p(r.showPhysicalPageNumber,_.showPhysicalPageNumber),r.papersizeWidth=b(r.papersizeWidth,_.papersizeWidth),r.papersizeHeight=b(r.papersizeHeight,_.papersizeHeight),r.paperSize=F(r.paperSize,_.paperSize),r.orientation=F(r.orientation,_.orientation),r.dpi=b(r.dpi,_.dpi),(!Number.isFinite(r.dpi)||r.dpi<=0)&&(r.dpi=_.dpi);const i=s=>Object.prototype.hasOwnProperty.call(e,s)&&e[s]!=="",n=Object.prototype.hasOwnProperty.call(t,"papersizeWidth")||Object.prototype.hasOwnProperty.call(a,"papersizeWidth")||i("papersizeWidth"),l=Object.prototype.hasOwnProperty.call(t,"papersizeHeight")||Object.prototype.hasOwnProperty.call(a,"papersizeHeight")||i("papersizeHeight");if(!n&&!l){const s=G({paperSize:r.paperSize,orientation:r.orientation,dpi:r.dpi});s&&(r.papersizeWidth=s.width,r.papersizeHeight=s.height)}return r}const k=[{key:"repeatPaddt",datasetKey:"repeatPaddt",legacyKey:"repeat_paddt",defaultValue:!0,parser:p},{key:"insertPaddtDummyRowItems",datasetKey:"insertPaddtDummyRowItems",legacyKey:"insert_paddt_dummy_row_items",defaultValue:!0,parser:p},{key:"paddtMaxWordsPerSegment",datasetKey:"paddtMaxWordsPerSegment",legacyKey:"paddt_max_words_per_segment",defaultValue:200,parser:b},{key:"repeatPaddtRowheader",datasetKey:"repeatPaddtRowheader",legacyKey:"repeat_paddt_rowheader",defaultValue:!0,parser:p},{key:"paddtDebug",datasetKey:"paddtDebug",legacyKey:"paddt_debug",defaultValue:!1,parser:p},{key:"repeatPaddtDocinfo",datasetKey:"repeatPaddtDocinfo",legacyKey:"repeat_paddt_docinfo",defaultValue:!0,parser:p},{key:"repeatPaddtDocinfo002",datasetKey:"repeatPaddtDocinfo002",legacyKey:"repeat_paddt_docinfo002",defaultValue:!0,parser:p},{key:"repeatPaddtDocinfo003",datasetKey:"repeatPaddtDocinfo003",legacyKey:"repeat_paddt_docinfo003",defaultValue:!0,parser:p},{key:"repeatPaddtDocinfo004",datasetKey:"repeatPaddtDocinfo004",legacyKey:"repeat_paddt_docinfo004",defaultValue:!0,parser:p},{key:"repeatPaddtDocinfo005",datasetKey:"repeatPaddtDocinfo005",legacyKey:"repeat_paddt_docinfo005",defaultValue:!0,parser:p}],N=k.reduce(function(o,e){return o[e.key]=e.defaultValue,o},{});function ae(){return V(k)}function re(o){return M(k,o)}function oe(o,e){e=e||{};var t=ae(),a=re(o&&o.dataset||{}),r={};for(var i in N)Object.prototype.hasOwnProperty.call(N,i)&&(r[i]=N[i]);for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(r[l]=a[l]);for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=e[s]);return r.paddtDebug=p(r.paddtDebug,N.paddtDebug),r.paddtMaxWordsPerSegment=b(r.paddtMaxWordsPerSegment,N.paddtMaxWordsPerSegment),(!Number.isFinite(r.paddtMaxWordsPerSegment)||r.paddtMaxWordsPerSegment<=0)&&(r.paddtMaxWordsPerSegment=N.paddtMaxWordsPerSegment),r}function ne(o,e){const t=document.createElement("table");return t.className="dummy_row",t.setAttribute("width",`${o.papersizeWidth}px`),t.setAttribute("cellspacing","0"),t.setAttribute("cellpadding","0"),t.innerHTML=`<tr style="height:${f(e)}px;"><td style="border:0px solid black;"></td></tr>`,t}function ie(o){const e=document.createElement("table");return e.className="dummy_row_item",e.setAttribute("width",`${o.papersizeWidth}px`),e.setAttribute("cellspacing","0"),e.setAttribute("cellpadding","0"),o.customDummyRowItemContent?e.innerHTML=o.customDummyRowItemContent:e.innerHTML=`<tr style="height:${f(o.heightOfDummyRowItem)}px;"><td style="border:0px solid black;"></td></tr>`,e}function A(o,e,t){const a=f(o.heightOfDummyRowItem),r=f(t);if(a<=0||r<=0)return;const i=Math.floor(r/a);for(let n=0;n<i;n+=1)e.appendChild(ie(o))}function se(o,e,t){const a=f(t);a<=0||e.appendChild(ne(o,a))}function le(o,e,t,a){if(!o.insertDummyRowItemWhileFormatTable)return f(a);const r=f(t-a);if(r>0){A(o,e,r);const i=f(o.heightOfDummyRowItem);if(i>0){const n=f(r%i);return f(t-n)}}return f(a)}function ce(o,e,t,a){if(!o.insertDummyRowWhileFormatTable)return f(a);const r=f(t-a);return r>0?(se(o,e,r),f(a+r)):f(a)}function de(o,e,t,a,r){if(!o.insertFooterSpacerWithDummyRowItemWhileFormatTable||r)return{currentHeight:f(a),skipFooterSpacer:!1};const i=f(t-a);let n=f(a);if(i>0){A(o,e,i);const l=f(o.heightOfDummyRowItem);if(l>0){const s=f(i%l);n=f(t-s)}}return{currentHeight:n,skipFooterSpacer:!0}}function pe(o,e,t,a,r,i){if(!o.insertFooterSpacerWhileFormatTable)return;const n=i.cloneNode(!0);let l=f(t-a);r&&r.nonRepeating&&(l-=f(r.nonRepeating)),n.style.height=`${Math.max(0,l)}px`,e.appendChild(n)}function ue(o,e){!o||!e||o.classList.contains(`${e}_processed`)||(o.classList.remove(e),o.classList.add(`${e}_processed`))}function fe(o){return o?f(o.offsetHeight||o.getBoundingClientRect().height):0}function me(){const o=document.createElement("div");return o.classList.add("div_page_break_before"),o.style.pageBreakBefore="always",o.style.height="0px",o}function he(o,e,t,a){if(!e)return null;const r=e.cloneNode(!0);return o.appendChild(r),t&&t(`append ${a}`),r}function ge(o,e,t,a,r){if(!e)return;const i=e.cloneNode(!0);o.appendChild(i),t&&t(`append ${r||"prowitem"} ${a}`)}const u={markAsProcessed:ue,measureHeight:fe,createPageBreakDivider:me,appendClone:he,appendRowItem:ge},ye=".prowitem, .ptac-rowitem, .paddt-rowitem",Pe=200,we=200;function O(o,e){var t=o.cloneNode(!1);return t.textContent=e.join(" "),t.outerHTML||""}function z(o,e){if(!o)return[];var t=(o.textContent||"").trim();if(!t)return[o.outerHTML||""];var a=t.split(/\s+/).filter(function(l){return l&&l.length>0});if(a.length<=e)return[o.outerHTML||""];for(var r=[],i=[],n=0;n<a.length;n+=1)i.push(a[n]),i.length>=e&&(r.push(O(o,i)),i=[]);return i.length>0&&r.push(O(o,i)),r}function _e(o,e){return z(o,e)}class x{constructor(e,t){this.formEl=e,this.config=t,this.debug=!!t.debug,this.nUp=Math.max(1,Math.floor(Number(t.nUp||1))),this.showLogicalPageNumber=t.showLogicalPageNumber!==!1,this.showPhysicalPageNumber=!!t.showPhysicalPageNumber,this.paddtConfig=oe(e,{}),this.paddtDebug=!!this.paddtConfig.paddtDebug,this.currentPage=1,this.currentPhysicalPage=0,this.pagesInCurrentPhysical=0,this.currentPhysicalWrapper=null,this.currentPageContainer=null,this.logicalPageNumberClones=[],this.physicalPageNumberClones=[],this.logicalPageToPhysicalPage=[]}log(e){this.debug&&console.log(`[printform] ${e}`)}initializeOutputContainer(){const e=document.createElement("div");return e.classList.add("printform_formatter"),this.formEl.parentNode.insertBefore(e,this.formEl),e}initializePhysicalWrapper(e){this.currentPhysicalWrapper?(e.appendChild(u.createPageBreakDivider()),this.currentPhysicalPage+=1):this.currentPhysicalPage=1;const t=document.createElement("div");return t.classList.add("physical_page_wrapper"),t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="flex-start",t.style.width=`${this.config.papersizeWidth}px`,e.appendChild(t),this.currentPhysicalWrapper=t,this.pagesInCurrentPhysical=0,t}ensureCurrentPageContainer(e){return this.currentPhysicalWrapper||this.initializePhysicalWrapper(e),this.currentPageContainer||this.createNewLogicalPage(e),this.currentPageContainer}createNewLogicalPage(e){(!this.currentPhysicalWrapper||this.pagesInCurrentPhysical>=this.nUp)&&this.initializePhysicalWrapper(e);const t=document.createElement("div");return t.classList.add("printform_page"),t.style.width=`${this.config.papersizeWidth}px`,t.style.minHeight=`${this.config.papersizeHeight}px`,this.currentPhysicalWrapper.appendChild(t),this.currentPageContainer=t,this.pagesInCurrentPhysical+=1,this.logicalPageToPhysicalPage[this.currentPage]=this.currentPhysicalPage,t}getCurrentPageContainer(e){return this.ensureCurrentPageContainer(e)}collectSections(){this.expandPaddtSegments(),this.expandPtacSegments();const e=J.map(n=>{const l=this.formEl.querySelector(`.${n.className}`);return l?{key:n.key,className:n.className,repeatFlag:n.repeatFlag,element:l}:null}).filter(Boolean),t=Q.map(n=>{const l=this.formEl.querySelector(`.${n.className}`);return l?{key:n.key,className:n.className,repeatFlag:n.repeatFlag,element:l}:null}).filter(Boolean),a=Array.from(this.formEl.querySelectorAll(ye)),r=a.filter(n=>this.isPaddtRow(n)),i=a.filter(n=>!this.isPaddtRow(n));return this.paddtRows=r,{header:this.formEl.querySelector(".pheader"),docInfos:e,rowHeader:this.formEl.querySelector(".prowheader"),footerVariants:t,footerLogo:this.formEl.querySelector(`.${L.className}`),footerPagenum:this.formEl.querySelector(`.${D.className}`),rows:i}}isPaddtRow(e){return e?e.classList.contains("paddt_segment")||e.classList.contains("paddt")||e.classList.contains("paddt-rowitem")||e.classList.contains("paddt-rowitem_processed"):!1}isPtacRow(e){return e?e.classList.contains("ptac_segment")||e.classList.contains("ptac")||e.classList.contains("ptac-rowitem")||e.classList.contains("ptac-rowitem_processed"):!1}getRowBaseClass(e){return e?this.isPaddtRow(e)?"paddt-rowitem":this.isPtacRow(e)?"ptac-rowitem":"prowitem":"prowitem"}shouldSkipRowHeaderForRow(e){return!e||!this.config.repeatRowheader?!1:this.isPtacRow(e)?!this.config.repeatPtacRowheader:this.isPaddtRow(e)?!(this.paddtConfig&&this.paddtConfig.repeatPaddtRowheader):!1}initializePageContext(e){return{baseLimit:e,limit:e,skipRowHeader:!1,isPtacPage:!1,isPaddtPage:!1}}refreshPageContextForRow(e,t,a){if(!e)return e;const r=this.shouldSkipRowHeaderForRow(t),i=a.rowHeader||0;return e.skipRowHeader=r,e.isPtacPage=this.isPtacRow(t),e.isPaddtPage=this.isPaddtRow(t),e.limit=e.baseLimit+(r?i:0),e}shouldSkipDummyRowItemsForContext(e){return!!(e&&(e.isPtacPage&&!this.config.insertPtacDummyRowItems||e.isPaddtPage&&!(this.paddtConfig&&this.paddtConfig.insertPaddtDummyRowItems)))}expandPaddtSegments(){if(this.formEl.dataset.paddtExpanded==="true")return;const e=Array.from(this.formEl.querySelectorAll(".paddt"));if(e.length===0){this.formEl.dataset.paddtExpanded="true";return}var t=this.paddtConfig&&this.paddtConfig.paddtMaxWordsPerSegment||we;e.forEach(a=>{if(!a||a.dataset.paddtSegment==="true")return;const r=a.querySelector("td > div")||a.querySelector("td");if(!r){a.classList.add("paddt-rowitem","paddt_segment"),a.dataset.paddtSegment="true";return}const i=Array.from(r.querySelectorAll("p"));var n=null;i.length>1&&(n=i.shift());const l=i;if(l.length===0){a.classList.add("paddt-rowitem","paddt_segment"),a.dataset.paddtSegment="true";return}const s=n?n.outerHTML:"",c=l.reduce(function(g,w){const C=_e(w,t);return g.concat(C)},[]);if(c.length===0){r.innerHTML=s,a.classList.add("paddt-rowitem","paddt_segment"),a.dataset.paddtSegment="true";return}const d=[];if(s){d.push(s+c[0]);for(var m=1;m<c.length;m+=1)d.push(c[m])}else for(var h=0;h<c.length;h+=1)d.push(c[h]);if(d.length===0){r.innerHTML=s,a.classList.add("paddt-rowitem","paddt_segment"),a.dataset.paddtSegment="true";return}r.innerHTML=d[0],a.classList.add("paddt-rowitem","paddt_segment"),a.dataset.paddtSegment="true";for(var P=a,y=1;y<d.length;y+=1){const g=a.cloneNode(!0);g.dataset.paddtSegment="true";const w=g.querySelector("td > div")||g.querySelector("td");w&&(w.innerHTML=d[y]),P.parentNode.insertBefore(g,P.nextSibling),P=g}}),this.formEl.dataset.paddtExpanded="true"}expandPtacSegments(){if(this.formEl.dataset.ptacExpanded==="true")return;const e=Array.from(this.formEl.querySelectorAll(".ptac"));if(e.length===0){this.formEl.dataset.ptacExpanded="true";return}e.forEach(t=>{if(!t||t.dataset.ptacSegment==="true")return;const a=t.querySelector("td > div")||t.querySelector("td");if(!a){t.classList.add("ptac-rowitem","ptac_segment"),t.dataset.ptacSegment="true";return}const r=Array.from(a.querySelectorAll("p"));var i=null;r.length>1&&(i=r.shift());const n=r;if(n.length===0){t.classList.add("ptac-rowitem","ptac_segment"),t.dataset.ptacSegment="true";return}const l=i?i.outerHTML:"",s=n.reduce(function(y,g){const w=z(g,Pe);return y.concat(w)},[]);if(s.length===0){a.innerHTML=l,t.classList.add("ptac-rowitem","ptac_segment"),t.dataset.ptacSegment="true";return}const c=[];if(l){c.push(l+s[0]);for(var d=1;d<s.length;d+=1)c.push(s[d])}else for(var m=0;m<s.length;m+=1)c.push(s[m]);if(c.length===0){a.innerHTML=l,t.classList.add("ptac-rowitem","ptac_segment"),t.dataset.ptacSegment="true";return}a.innerHTML=c[0],t.classList.add("ptac-rowitem","ptac_segment"),t.dataset.ptacSegment="true";for(var h=t,P=1;P<c.length;P+=1){const y=t.cloneNode(!0);y.dataset.ptacSegment="true";const g=y.querySelector("td > div")||y.querySelector("td");g&&(g.innerHTML=c[P]),h.parentNode.insertBefore(y,h.nextSibling),h=y}}),this.formEl.dataset.ptacExpanded="true"}createFooterSpacerTemplate(){const e=document.createElement("div");return e.classList.add("pfooter_spacer","paper_width"),e.style.height="0px",e}ensureFirstPageSections(e,t,a,r,i){let n=0;return t.header&&(u.appendClone(e,t.header,r,"pheader"),this.config.repeatHeader||(n+=a.header)),t.docInfos.forEach(l=>{const s=u.appendClone(e,l.element,r,l.className);this.registerPageNumberClone(s),this.config[l.repeatFlag]||(n+=a.docInfos[l.key]||0)}),t.rowHeader&&!i&&(u.appendClone(e,t.rowHeader,r,"prowheader"),this.config.repeatRowheader||(n+=a.rowHeader)),n}appendRepeatingSections(e,t,a,r){this.config.repeatHeader&&u.appendClone(e,t.header,a,"pheader"),t.docInfos.forEach(i=>{if(this.config[i.repeatFlag]){const n=u.appendClone(e,i.element,a,i.className);this.registerPageNumberClone(n)}}),this.config.repeatRowheader&&!r&&u.appendClone(e,t.rowHeader,a,"prowheader")}registerPageNumberClone(e){if(!e)return!1;let t=!1;if(this.showLogicalPageNumber&&e.querySelector("[data-page-number], [data-page-total], [data-page-number-container]")&&(T(e,this.currentPage,null),this.logicalPageNumberClones.push({node:e,pageNumber:this.currentPage}),t=!0),this.showPhysicalPageNumber&&e.querySelector("[data-physical-page-number], [data-physical-page-total], [data-physical-page-number-container]")){const a=this.logicalPageToPhysicalPage[this.currentPage]||this.currentPhysicalPage||1;I(e,a,null),this.physicalPageNumberClones.push({node:e,pageNumber:a}),t=!0}return t}appendRepeatingFooters(e,t,a){t.footerVariants.forEach(r=>{this.config[r.repeatFlag]&&u.appendClone(e,r.element,a,r.className)}),this.config.repeatFooterLogo&&u.appendClone(e,t.footerLogo,a,L.className),this.config.repeatFooterPagenum&&this.appendFooterPageNumber(e,t,a)}appendFinalFooters(e,t,a){t.footerVariants.forEach(r=>{u.appendClone(e,r.element,a,r.className)}),u.appendClone(e,t.footerLogo,a,L.className),this.appendFooterPageNumber(e,t,a)}appendFooterPageNumber(e,t,a){if(!t.footerPagenum)return;const r=t.footerPagenum.cloneNode(!0);e.appendChild(r),this.registerPageNumberClone(r),a&&a(`append ${D.className} page ${this.currentPage}`)}updatePageNumberTotals(){if(!this.logicalPageNumberClones.length&&!this.physicalPageNumberClones.length)return;const e=this.currentPage,t=this.currentPhysicalPage||1;this.logicalPageNumberClones.forEach(a=>{T(a.node,a.pageNumber,e)}),this.physicalPageNumberClones.forEach(a=>{I(a.node,a.pageNumber,t)})}measureSections(e){const t={header:u.measureHeight(e.header),docInfos:{},rowHeader:u.measureHeight(e.rowHeader),footerVariants:{},footerLogo:u.measureHeight(e.footerLogo),footerPagenum:u.measureHeight(e.footerPagenum)};return e.docInfos.forEach(a=>{t.docInfos[a.key]=u.measureHeight(a.element)}),e.footerVariants.forEach(a=>{t.footerVariants[a.key]=u.measureHeight(a.element)}),t}markSectionsProcessed(e){u.markAsProcessed(e.header,"pheader"),e.docInfos.forEach(t=>{u.markAsProcessed(t.element,t.className)}),u.markAsProcessed(e.rowHeader,"prowheader"),e.footerVariants.forEach(t=>{u.markAsProcessed(t.element,t.className)}),u.markAsProcessed(e.footerLogo,L.className),u.markAsProcessed(e.footerPagenum,D.className)}renderRows(e,t,a,r,i,n,l){let s=0;const c=this.initializePageContext(i);return t.rows.forEach((d,m)=>{const h=u.measureHeight(d),P=this.getRowBaseClass(d),y=this.isPtacRow(d),g=this.isPaddtRow(d);if(!h){u.markAsProcessed(d,P);return}if(s===0){this.refreshPageContextForRow(c,d,a);const w=this.getCurrentPageContainer(e);s+=this.ensureFirstPageSections(w,t,a,l,c.skipRowHeader)}if(s+=h,u.markAsProcessed(d,P),d.classList.contains("tb_page_break_before")){s-=h;const w=this.shouldSkipDummyRowItemsForContext(c),C=this.shouldSkipRowHeaderForRow(d);s=this.prepareNextPage(e,t,l,c.limit,s,r,n,C,w),this.refreshPageContextForRow(c,d,a);const E=this.getCurrentPageContainer(e);u.appendRowItem(E,d,l,m,P),s=h,y||(c.isPtacPage=!1),g||(c.isPaddtPage=!1)}else if(s<=c.limit){const w=this.getCurrentPageContainer(e);u.appendRowItem(w,d,l,m,P),y||(c.isPtacPage=!1),g||(c.isPaddtPage=!1)}else{s-=h;const w=this.shouldSkipDummyRowItemsForContext(c),C=this.shouldSkipRowHeaderForRow(d);s=this.prepareNextPage(e,t,l,c.limit,s,r,n,C,w),this.refreshPageContextForRow(c,d,a);const E=this.getCurrentPageContainer(e);u.appendRowItem(E,d,l,m,P),s=h,y||(c.isPtacPage=!1),g||(c.isPaddtPage=!1)}}),{currentHeight:s,pageLimit:c.limit,isPtacPage:c.isPtacPage,isPaddtPage:c.isPaddtPage}}prepareNextPage(e,t,a,r,i,n,l,s,c){const d=this.getCurrentPageContainer(e),m=this.applyRemainderSpacing(d,r,i,n,l,{skipDummyRowItems:c});this.appendRepeatingFooters(d,t,a),this.currentPage+=1,this.currentPageContainer=null,this.createNewLogicalPage(e);const h=this.getCurrentPageContainer(e);return this.appendRepeatingSections(h,t,a,s),m}applyRemainderSpacing(e,t,a,r,i,n){const l=n&&n.skipDummyRowItems;let s=f(a);l||(s=le(this.config,e,t,s)),s=ce(this.config,e,t,s);const c=de(this.config,e,t,s,l);return s=c.currentHeight,c.skipFooterSpacer||pe(this.config,e,t,s,r,i),f(s)}computeHeightPerPage(e,t){let a=this.config.papersizeHeight;return this.config.repeatHeader&&e.header&&(a-=t.header),e.docInfos.forEach(r=>{this.config[r.repeatFlag]&&(a-=t.docInfos[r.key]||0)}),this.config.repeatRowheader&&e.rowHeader&&(a-=t.rowHeader),e.footerVariants.forEach(r=>{this.config[r.repeatFlag]&&(a-=t.footerVariants[r.key]||0)}),this.config.repeatFooterLogo&&e.footerLogo&&(a-=t.footerLogo),this.config.repeatFooterPagenum&&e.footerPagenum&&(a-=t.footerPagenum||0),Math.max(0,a)}computeFooterState(e,t){const a=t.footerLogo||0,r=t.footerPagenum||0,n=e.footerVariants.reduce((d,m)=>{const h=t.footerVariants[m.key]||0;return d+h},0)+a+r;let s=e.footerVariants.reduce((d,m)=>{const h=t.footerVariants[m.key]||0;return this.config[m.repeatFlag]?d+h:d},0);this.config.repeatFooterLogo&&(s+=a),this.config.repeatFooterPagenum&&(s+=r);const c=Math.max(0,n-s);return{totalFinal:n,repeating:s,nonRepeating:c}}finalizeDocument(e,t,a,r,i,n,l){const s=i?i.currentHeight:0,c=i&&i.pageLimit?i.pageLimit:r,d=!!(i&&(i.isPtacPage&&!this.config.insertPtacDummyRowItems||i.isPaddtPage&&!(this.paddtConfig&&this.paddtConfig.insertPaddtDummyRowItems))),m=a.totalFinal-a.repeating,h=s+m;if(h<=c){const g=this.getCurrentPageContainer(e);this.applyRemainderSpacing(g,c,h,a,n,{skipDummyRowItems:d}),this.appendFinalFooters(g,t,l);return}this.prepareNextPage(e,t,l,c,s,a,n,!1,d);const P=m,y=this.getCurrentPageContainer(e);this.applyRemainderSpacing(y,r,P,a,n,null),this.appendFinalFooters(y,t,l)}format(){const e=this.debug?this.log.bind(this):null,t=this.initializeOutputContainer();this.ensureCurrentPageContainer(t);const a=this.collectSections(),r=this.measureSections(a),i=this.createFooterSpacerTemplate();this.markSectionsProcessed(a);const n=this.computeFooterState(a,r),l=this.computeHeightPerPage(a,r),s=this.renderRows(t,a,r,n,l,i,e);if(this.finalizeDocument(t,a,n,l,s,i,e),this.paddtRows&&this.paddtRows.length){this.currentPage+=1,this.currentPageContainer=null,this.initializePhysicalWrapper(t),this.createNewLogicalPage(t);var c={docInfo:this.paddtConfig.repeatPaddtDocinfo,docInfo002:this.paddtConfig.repeatPaddtDocinfo002,docInfo003:this.paddtConfig.repeatPaddtDocinfo003,docInfo004:this.paddtConfig.repeatPaddtDocinfo004,docInfo005:this.paddtConfig.repeatPaddtDocinfo005},d=a.docInfos.filter(function(g){var w=c[g.key];return w===void 0?!0:!!w});const m={header:a.header,docInfos:d,rowHeader:a.rowHeader,footerVariants:[],footerLogo:a.footerLogo,footerPagenum:a.footerPagenum,rows:this.paddtRows},h=this.computeFooterState(m,r),P=this.computeHeightPerPage(m,r),y=this.renderRows(t,m,r,h,P,i,e);this.finalizeDocument(t,m,h,P,y,i,e)}return this.updatePageNumberTotals(),t.classList.add("printform_formatter_processed"),this.formEl.remove(),t}}function be(o){return new Promise((e,t)=>{setTimeout(e,o)})}async function q(o={}){const e=typeof window<"u"?window:globalThis;if(!e.__printFormProcessing&&!(!o.force&&e.__printFormProcessed)){e.__printFormProcessing=!0;try{const t=e.document;if(!t)return;const a=Array.from(t.querySelectorAll(".printform"));for(let r=0;r<a.length;r+=1){const i=a[r],n=W(i,o);try{await be(1)}catch(l){console.error("pauseInMilliseconds error",l)}try{const s=new x(i,n).format();r>0&&s&&s.parentNode&&s.parentNode.insertBefore(u.createPageBreakDivider(),s)}catch(l){console.error("printform format error",l)}}e.__printFormProcessed=!0}finally{e.__printFormProcessing=!1}}}function Se(o,e={}){const t=W(o,e);return new x(o,t).format()}const H={formatAll:q,format:Se,DEFAULT_CONFIG:_,DEFAULT_PADDT_CONFIG:N},S=typeof window<"u"?window:null;if(S)if(S.__printFormScriptLoaded__)S.PrintForm=S.PrintForm||H;else{S.__printFormScriptLoaded__=!0,S.PrintForm=S.PrintForm||{},Object.assign(S.PrintForm,H);const o=S.document;o&&o.addEventListener&&o.addEventListener("DOMContentLoaded",()=>{q()})}return H}();
